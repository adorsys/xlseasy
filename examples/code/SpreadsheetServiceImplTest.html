<pre style='color:#000000;background:#ffffff;'><html><body style='color:#000000; background:#ffffff; '><pre>
<span style='color:#800000; font-weight:bold; '>package</span><span style='color:#004a43; '> org</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>adorsys</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>xlseasy</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>cbe</span><span style='color:#800080; '>;</span>

<span style='color:#800000; font-weight:bold; '>import</span><span style='color:#004a43; '> static org</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>junit</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>Assert</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>assertEquals</span><span style='color:#800080; '>;</span>
<span style='color:#800000; font-weight:bold; '>import</span><span style='color:#004a43; '> static org</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>junit</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>Assert</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>assertFalse</span><span style='color:#800080; '>;</span>
<span style='color:#800000; font-weight:bold; '>import</span><span style='color:#004a43; '> static org</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>junit</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>Assert</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>assertTrue</span><span style='color:#800080; '>;</span>

<span style='color:#800000; font-weight:bold; '>import</span><span style='color:#004a43; '> java</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>io</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>FileInputStream</span><span style='color:#800080; '>;</span>
<span style='color:#800000; font-weight:bold; '>import</span><span style='color:#004a43; '> java</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>io</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>FileNotFoundException</span><span style='color:#800080; '>;</span>
<span style='color:#800000; font-weight:bold; '>import</span><span style='color:#004a43; '> java</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>io</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>FileOutputStream</span><span style='color:#800080; '>;</span>
<span style='color:#800000; font-weight:bold; '>import</span><span style='color:#004a43; '> java</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>io</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>InputStream</span><span style='color:#800080; '>;</span>
<span style='color:#800000; font-weight:bold; '>import</span><span style='color:#004a43; '> java</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>io</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>OutputStream</span><span style='color:#800080; '>;</span>
<span style='color:#800000; font-weight:bold; '>import</span><span style='color:#004a43; '> java</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>util</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>Date</span><span style='color:#800080; '>;</span>
<span style='color:#800000; font-weight:bold; '>import</span><span style='color:#004a43; '> java</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>util</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>List</span><span style='color:#800080; '>;</span>

<span style='color:#800000; font-weight:bold; '>import</span><span style='color:#004a43; '> org</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>adorsys</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>xlseasy</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>annotation</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>SpreadsheetService</span><span style='color:#800080; '>;</span>
<span style='color:#800000; font-weight:bold; '>import</span><span style='color:#004a43; '> org</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>adorsys</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>xlseasy</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>boot</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>SpreadSheetServiceBootStrap</span><span style='color:#800080; '>;</span>
<span style='color:#800000; font-weight:bold; '>import</span><span style='color:#004a43; '> org</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>apache</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>commons</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>lang</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>BooleanUtils</span><span style='color:#800080; '>;</span>
<span style='color:#800000; font-weight:bold; '>import</span><span style='color:#004a43; '> org</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>junit</span><span style='color:#808030; '>.</span><span style='color:#004a43; '>Test</span><span style='color:#800080; '>;</span>

<span style='color:#3f5fbf; '>/**</span>
<span style='color:#3f5fbf; '>&#xa0;</span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '> The class SpreadsheetServiceImplTest.</span>
<span style='color:#3f5fbf; '>&#xa0;*/</span>
<span style='color:#800000; font-weight:bold; '>public</span> <span style='color:#800000; font-weight:bold; '>class</span> SpreadsheetServiceImplTest <span style='color:#800080; '>{</span>

	<span style='color:#3f5fbf; '>/**</span>
<span style='color:#3f5fbf; '>	 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '> Loads a spreadsheet.</span>
<span style='color:#3f5fbf; '>	 */</span>
	<span style='color:#808030; '>@</span>Test
	<span style='color:#800000; font-weight:bold; '>public</span> <span style='color:#bb7977; '>void</span> testLoadSpreadsheet<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>

		<span style='color:#696969; '>// Creates a new SpreadSheetServiceBootStrap.</span>
		SpreadSheetServiceBootStrap bootStrap <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> SpreadSheetServiceBootStrap<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

		<span style='color:#696969; '>// Sets the workbook's class.</span>
		bootStrap<span style='color:#808030; '>.</span>setWorkbookKlass<span style='color:#808030; '>(</span>ShopManagement<span style='color:#808030; '>.</span>class<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

		<span style='color:#696969; '>// Creates a new SpreadsheetService.</span>
		SpreadsheetService spreadService <span style='color:#808030; '>=</span> bootStrap<span style='color:#808030; '>.</span>createSpreadService<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

		<span style='color:#696969; '>// The file to load.</span>
		<span style='color:#bb7977; font-weight:bold; '>String</span> managementFile <span style='color:#808030; '>=</span> <span style='color:#0000e6; '>"management.xls"</span><span style='color:#800080; '>;</span>

		<span style='color:#696969; '>// Finds the file to load in the resource.</span>
		<span style='color:#bb7977; font-weight:bold; '>InputStream</span> managementStream <span style='color:#808030; '>=</span> SpreadsheetServiceImplTest<span style='color:#808030; '>.</span>class
				<span style='color:#808030; '>.</span>getResourceAsStream<span style='color:#808030; '>(</span>managementFile<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

		<span style='color:#696969; '>// Creates a new ShopManagement and save the loaded spreadsheet into.</span>
		ShopManagement shopManagement <span style='color:#808030; '>=</span> spreadService<span style='color:#808030; '>.</span>loadSpreadsheet<span style='color:#808030; '>(</span>
				managementStream<span style='color:#808030; '>,</span> ShopManagement<span style='color:#808030; '>.</span>class<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

		<span style='color:#3f5fbf; '>/**</span>
<span style='color:#3f5fbf; '>		 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '> Verifies if all spreadsheets have been read and objects created.</span>
<span style='color:#3f5fbf; '>		 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '> </span>
<span style='color:#3f5fbf; '>		 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '> This verification is for the case the number of expected objects from</span>
<span style='color:#3f5fbf; '>		 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '> each sheet is known. The program breaks if this number isn't the same</span>
<span style='color:#3f5fbf; '>		 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '> as the number of objects contained in the sheet.</span>
<span style='color:#3f5fbf; '>		 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '> </span>
<span style='color:#3f5fbf; '>		 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '> In this case</span><span style='color:#7f9fbf; font-weight:bold; '>,</span><span style='color:#3f5fbf; '> we're expected </span><span style='color:#008c00; '>3</span><span style='color:#3f5fbf; '> objects from the sheets clients and</span>
<span style='color:#3f5fbf; '>		 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '> products and </span><span style='color:#008c00; '>5</span><span style='color:#3f5fbf; '> objects from users.</span>
<span style='color:#3f5fbf; '>		 */</span>
		assertEquals<span style='color:#808030; '>(</span><span style='color:#008c00; '>3</span><span style='color:#808030; '>,</span> shopManagement<span style='color:#808030; '>.</span>getSuppliers<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>size<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertEquals<span style='color:#808030; '>(</span><span style='color:#008c00; '>3</span><span style='color:#808030; '>,</span> shopManagement<span style='color:#808030; '>.</span>getProducts<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>size<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

		<span style='color:#696969; '>// Reads through supplier list and verify entries of supplier by</span>
		<span style='color:#696969; '>// iterating through the list and reading the attributes</span>
		<span style='color:#bb7977; font-weight:bold; '>List</span><span style='color:#808030; '>&lt;</span>Supplier<span style='color:#808030; '>></span> suppliers <span style='color:#808030; '>=</span> shopManagement<span style='color:#808030; '>.</span>getSuppliers<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertEquals<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"Consor"</span><span style='color:#808030; '>,</span> suppliers<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertEquals<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"flater"</span><span style='color:#808030; '>,</span> suppliers<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getStreet<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertEquals<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"90559"</span><span style='color:#808030; '>,</span> suppliers<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getZipcode<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertEquals<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"Nuremberg"</span><span style='color:#808030; '>,</span> suppliers<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getCity<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertTrue<span style='color:#808030; '>(</span>suppliers<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>isVip<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

		assertEquals<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"Camsuco"</span><span style='color:#808030; '>,</span> suppliers<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertEquals<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"Dorotheen"</span><span style='color:#808030; '>,</span> suppliers<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getStreet<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertEquals<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"12345"</span><span style='color:#808030; '>,</span> suppliers<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getZipcode<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertEquals<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"Essen"</span><span style='color:#808030; '>,</span> suppliers<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getCity<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertFalse<span style='color:#808030; '>(</span>suppliers<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>isVip<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

		assertEquals<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"Hap"</span><span style='color:#808030; '>,</span> suppliers<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertEquals<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"Am Hartweg"</span><span style='color:#808030; '>,</span> suppliers<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getStreet<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertEquals<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"08146"</span><span style='color:#808030; '>,</span> suppliers<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getZipcode<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertEquals<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"Dortmund"</span><span style='color:#808030; '>,</span> suppliers<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getCity<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertTrue<span style='color:#808030; '>(</span>suppliers<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>isVip<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

		<span style='color:#696969; '>// Reads through product list and verify entries of product by iterating</span>
		<span style='color:#696969; '>// through the list and reading the attributes</span>
		<span style='color:#bb7977; font-weight:bold; '>List</span><span style='color:#808030; '>&lt;</span>Product<span style='color:#808030; '>></span> products <span style='color:#808030; '>=</span> shopManagement<span style='color:#808030; '>.</span>getProducts<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

		assertEquals<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"Papier"</span><span style='color:#808030; '>,</span> products<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertEquals<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"DNA4 Blaetter"</span><span style='color:#808030; '>,</span> products<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getDescription<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertEquals<span style='color:#808030; '>(</span><span style='color:#008000; '>23.0</span><span style='color:#808030; '>,</span> products<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getAmount<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

		assertEquals<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"Zucker"</span><span style='color:#808030; '>,</span> products<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertEquals<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"fuer Kaffe"</span><span style='color:#808030; '>,</span> products<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getDescription<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertEquals<span style='color:#808030; '>(</span><span style='color:#008000; '>25.0</span><span style='color:#808030; '>,</span> products<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getAmount<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

		assertEquals<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"Saft"</span><span style='color:#808030; '>,</span> products<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertEquals<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"Durst"</span><span style='color:#808030; '>,</span> products<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getDescription<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertEquals<span style='color:#808030; '>(</span><span style='color:#008000; '>24.0</span><span style='color:#808030; '>,</span> products<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>getAmount<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
	<span style='color:#800080; '>}</span>

	<span style='color:#3f5fbf; '>/**</span>
<span style='color:#3f5fbf; '>	 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '> Saves a spreadsheet and then loads it.</span>
<span style='color:#3f5fbf; '>	 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '> </span>
<span style='color:#3f5fbf; '>	 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '> </span><span style='color:#7f9fbf; font-weight:bold; '>@throws</span><span style='color:#3f5fbf; '> FileNotFoundException</span>
<span style='color:#3f5fbf; '>	 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '>             the exception</span>
<span style='color:#3f5fbf; '>	 */</span>
	<span style='color:#808030; '>@</span>Test
	<span style='color:#800000; font-weight:bold; '>public</span> <span style='color:#bb7977; '>void</span> testSaveSpreadsheet<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#800000; font-weight:bold; '>throws</span> <span style='color:#bb7977; font-weight:bold; '>FileNotFoundException</span> <span style='color:#800080; '>{</span>

		<span style='color:#696969; '>// Creates a new SpreadSheetServiceBootStrap.</span>
		SpreadSheetServiceBootStrap bootStrap <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> SpreadSheetServiceBootStrap<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

		<span style='color:#696969; '>// Sets the workbook's class.</span>
		bootStrap<span style='color:#808030; '>.</span>setWorkbookKlass<span style='color:#808030; '>(</span>ShopManagement<span style='color:#808030; '>.</span>class<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

		<span style='color:#696969; '>// Creates a new SpreadsheetService.</span>
		SpreadsheetService spreadService <span style='color:#808030; '>=</span> bootStrap<span style='color:#808030; '>.</span>createSpreadService<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

		<span style='color:#696969; '>// Creates a new ShopManagement to load the spreadsheet.</span>
		ShopManagement shopManagement <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> ShopManagement<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

		<span style='color:#696969; '>// Creates 2 suppliers for the test.</span>
		Supplier supplier1 <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> Supplier<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"Amzon"</span><span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"Friedriech"</span><span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"44524"</span><span style='color:#808030; '>,</span>
				<span style='color:#0000e6; '>"Hagen"</span><span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>true</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		Supplier supplier2 <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> Supplier<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"Bookstore"</span><span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"Mallinkrot"</span><span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"44415"</span><span style='color:#808030; '>,</span>
				<span style='color:#0000e6; '>"Dortmund"</span><span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>true</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

		<span style='color:#696969; '>// Creates 3 products for the test.</span>
		Product product1 <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> Product<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"Core jsf"</span><span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"jsf Book"</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>32.0</span><span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>true</span><span style='color:#808030; '>,</span>
				<span style='color:#800000; font-weight:bold; '>new</span> <span style='color:#bb7977; font-weight:bold; '>Date</span><span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		Product product2 <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> Product<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"Hibernate"</span><span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"hibernate Book"</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>25.0</span><span style='color:#808030; '>,</span>
				<span style='color:#800000; font-weight:bold; '>true</span><span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>new</span> <span style='color:#bb7977; font-weight:bold; '>Date</span><span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		<span style='color:#696969; '>// empty row</span>
		Product product3 <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> Product<span style='color:#808030; '>(</span><span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

		<span style='color:#696969; '>// Adds created objects (suppliers and products) to corresponding</span>
		<span style='color:#696969; '>// List&lt;Object></span>
		shopManagement<span style='color:#808030; '>.</span>getProducts<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>add<span style='color:#808030; '>(</span>product1<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		shopManagement<span style='color:#808030; '>.</span>getProducts<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>add<span style='color:#808030; '>(</span>product2<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		shopManagement<span style='color:#808030; '>.</span>getProducts<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>add<span style='color:#808030; '>(</span>product3<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		shopManagement<span style='color:#808030; '>.</span>getSuppliers<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>add<span style='color:#808030; '>(</span>supplier1<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		shopManagement<span style='color:#808030; '>.</span>getSuppliers<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>add<span style='color:#808030; '>(</span>supplier2<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

		<span style='color:#696969; '>// The file to create.</span>
		<span style='color:#bb7977; font-weight:bold; '>String</span> workbookFile <span style='color:#808030; '>=</span> <span style='color:#0000e6; '>"target/testmana.xls"</span><span style='color:#800080; '>;</span>

		<span style='color:#696969; '>// Creates a file stream to write to the file.</span>
		<span style='color:#bb7977; font-weight:bold; '>OutputStream</span> outputStream <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> <span style='color:#bb7977; font-weight:bold; '>FileOutputStream</span><span style='color:#808030; '>(</span>workbookFile<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

		<span style='color:#696969; '>// Saves the spreadsheet.</span>
		spreadService<span style='color:#808030; '>.</span>saveSpreadsheet<span style='color:#808030; '>(</span>ShopManagement<span style='color:#808030; '>.</span>class<span style='color:#808030; '>,</span> shopManagement<span style='color:#808030; '>,</span>
				outputStream<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

		<span style='color:#3f5fbf; '>/**</span>
<span style='color:#3f5fbf; '>		 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '> The spreadsheet has been created and saved into the file testmana</span><span style='color:#008c00; '>.</span><span style='color:#3f5fbf; '>xls</span>
<span style='color:#3f5fbf; '>		 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '> in the directory target. Now we want to check the content of the</span>
<span style='color:#3f5fbf; '>		 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '> created file. It's enough (for us) to check the first object. of each</span>
<span style='color:#3f5fbf; '>		 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '> sheet</span>
<span style='color:#3f5fbf; '>		 */</span>

		<span style='color:#696969; '>// Creates a file stream to open the file.</span>
		<span style='color:#bb7977; font-weight:bold; '>InputStream</span> managementStream <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> <span style='color:#bb7977; font-weight:bold; '>FileInputStream</span><span style='color:#808030; '>(</span>workbookFile<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

		<span style='color:#696969; '>// Loads spreadsheet.</span>
		shopManagement <span style='color:#808030; '>=</span> spreadService<span style='color:#808030; '>.</span>loadSpreadsheet<span style='color:#808030; '>(</span>managementStream<span style='color:#808030; '>,</span>
				ShopManagement<span style='color:#808030; '>.</span>class<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

		<span style='color:#696969; '>// Verifies if all spreadsheets have been read and checks the number of</span>
		<span style='color:#696969; '>// created objects. In our case, 2 suppliers and 3 products.</span>
		assertTrue<span style='color:#808030; '>(</span>shopManagement<span style='color:#808030; '>.</span>getSuppliers<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>size<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>=</span><span style='color:#808030; '>=</span> <span style='color:#008c00; '>2</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertTrue<span style='color:#808030; '>(</span>shopManagement<span style='color:#808030; '>.</span>getProducts<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>size<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>=</span><span style='color:#808030; '>=</span> <span style='color:#008c00; '>3</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

		<span style='color:#696969; '>// Reads through supplier list and verify entries of supplier by</span>
		<span style='color:#696969; '>// iterating through the list and reading the attributes</span>
		<span style='color:#bb7977; font-weight:bold; '>List</span><span style='color:#808030; '>&lt;</span>Supplier<span style='color:#808030; '>></span> suppliers <span style='color:#808030; '>=</span> shopManagement<span style='color:#808030; '>.</span>getSuppliers<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		checkSupplier<span style='color:#808030; '>(</span>supplier1<span style='color:#808030; '>,</span> suppliers<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		checkSupplier<span style='color:#808030; '>(</span>supplier2<span style='color:#808030; '>,</span> suppliers<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

		<span style='color:#696969; '>// Reads through product list and verify entries of product by iterating</span>
		<span style='color:#696969; '>// through the list and reading the attributes</span>
		<span style='color:#bb7977; font-weight:bold; '>List</span><span style='color:#808030; '>&lt;</span>Product<span style='color:#808030; '>></span> products <span style='color:#808030; '>=</span> shopManagement<span style='color:#808030; '>.</span>getProducts<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		checkProduct<span style='color:#808030; '>(</span>product1<span style='color:#808030; '>,</span> products<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		checkProduct<span style='color:#808030; '>(</span>product2<span style='color:#808030; '>,</span> products<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		checkProduct<span style='color:#808030; '>(</span>product3<span style='color:#808030; '>,</span> products<span style='color:#808030; '>.</span>get<span style='color:#808030; '>(</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
	<span style='color:#800080; '>}</span>

	<span style='color:#3f5fbf; '>/**</span>
<span style='color:#3f5fbf; '>	 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '> Test a supplier.</span>
<span style='color:#3f5fbf; '>	 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '> </span>
<span style='color:#3f5fbf; '>	 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '> </span><span style='color:#7f9fbf; font-weight:bold; '>@param</span><span style='color:#3f5fbf; '> expected</span>
<span style='color:#3f5fbf; '>	 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '>            the expected object</span>
<span style='color:#3f5fbf; '>	 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '> </span><span style='color:#7f9fbf; font-weight:bold; '>@param</span><span style='color:#3f5fbf; '> is</span>
<span style='color:#3f5fbf; '>	 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '>            the real object</span>
<span style='color:#3f5fbf; '>	 */</span>
	<span style='color:#800000; font-weight:bold; '>private</span> <span style='color:#bb7977; '>void</span> checkSupplier<span style='color:#808030; '>(</span>Supplier expected<span style='color:#808030; '>,</span> Supplier is<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
		assertEquals<span style='color:#808030; '>(</span>expected<span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span> is<span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertEquals<span style='color:#808030; '>(</span>expected<span style='color:#808030; '>.</span>getStreet<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span> is<span style='color:#808030; '>.</span>getStreet<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertEquals<span style='color:#808030; '>(</span>expected<span style='color:#808030; '>.</span>getZipcode<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span> is<span style='color:#808030; '>.</span>getZipcode<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertEquals<span style='color:#808030; '>(</span>expected<span style='color:#808030; '>.</span>getCity<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span> is<span style='color:#808030; '>.</span>getCity<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
	<span style='color:#800080; '>}</span>

	<span style='color:#3f5fbf; '>/**</span>
<span style='color:#3f5fbf; '>	 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '> Test a product.</span>
<span style='color:#3f5fbf; '>	 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '> </span>
<span style='color:#3f5fbf; '>	 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '> </span><span style='color:#7f9fbf; font-weight:bold; '>@param</span><span style='color:#3f5fbf; '> expected</span>
<span style='color:#3f5fbf; '>	 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '>            the expected object</span>
<span style='color:#3f5fbf; '>	 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '> </span><span style='color:#7f9fbf; font-weight:bold; '>@param</span><span style='color:#3f5fbf; '> is</span>
<span style='color:#3f5fbf; '>	 </span><span style='color:#7f9fbf; font-weight:bold; '>*</span><span style='color:#3f5fbf; '>            the real object</span>
<span style='color:#3f5fbf; '>	 */</span>
	<span style='color:#800000; font-weight:bold; '>private</span> <span style='color:#bb7977; '>void</span> checkProduct<span style='color:#808030; '>(</span>Product expected<span style='color:#808030; '>,</span> Product is<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
		assertEquals<span style='color:#808030; '>(</span>expected<span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span> is<span style='color:#808030; '>.</span>getName<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertEquals<span style='color:#808030; '>(</span>expected<span style='color:#808030; '>.</span>getDescription<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span> is<span style='color:#808030; '>.</span>getDescription<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertEquals<span style='color:#808030; '>(</span>expected<span style='color:#808030; '>.</span>getAmount<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>!</span><span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span> <span style='color:#808030; '>?</span> expected<span style='color:#808030; '>.</span>getAmount<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span>
				<span style='color:#808030; '>:</span> <span style='color:#bb7977; font-weight:bold; '>Double</span><span style='color:#808030; '>.</span>valueOf<span style='color:#808030; '>(</span><span style='color:#008000; '>0.0</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span> is<span style='color:#808030; '>.</span>getAmount<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertEquals<span style='color:#808030; '>(</span>BooleanUtils<span style='color:#808030; '>.</span>isTrue<span style='color:#808030; '>(</span>expected<span style='color:#808030; '>.</span>getTopSeller<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span>
				is<span style='color:#808030; '>.</span>getTopSeller<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
		assertEquals<span style='color:#808030; '>(</span>expected<span style='color:#808030; '>.</span>getValidFrom<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span> is<span style='color:#808030; '>.</span>getValidFrom<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
	<span style='color:#800080; '>}</span>
<span style='color:#800080; '>}</span>
</pre>